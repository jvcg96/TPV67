<!DOCTYPE html>
<html lang="es">

<head>
    <script>
        // Detectar si es desarrollo o producci√≥n
        const isDev = window.location.hostname === 'localhost' ||
            window.location.hostname === '127.0.0.1';

        if (isDev) {
            // Solo en desarrollo - Sin cach√©
            document.write('<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">');
            document.write('<meta http-equiv="Pragma" content="no-cache">');
            document.write('<meta http-equiv="Expires" content="0">');
            console.log('üîß Modo desarrollo - Cach√© desactivado');
        } else {
            // En producci√≥n - Con cach√©
            console.log('üöÄ Modo producci√≥n - Cach√© activado');
        }
    </script>
    <!-- B√°sicos primero -->
    <meta charset="UTF-8">
    <title>TPV Hosteler√≠a Pro - Sistema de Gesti√≥n</title>

    <!-- PWA Meta Tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="TPV Pro">
    <meta name="application-name" content="TPV Hosteler√≠a Pro">
    <meta name="theme-color" content="#ff6b6b">
    <meta name="msapplication-TileColor" content="#ff6b6b">
    <meta name="msapplication-navbutton-color" content="#ff6b6b">

    <!-- Manifest PWA -->
    <link rel="manifest" href="manifest.json">

    <!-- Iconos PWA -->
    <link rel="apple-touch-icon" sizes="192x192" href="./icons/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./icons/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./icons/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="128x128" href="./icons/icon-128x128.png">
    <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192x192.png">

    <!-- Splash Screen iOS -->
    <link rel="apple-touch-startup-image" href="./icons/icon-512x512.png">

    <!-- Fuentes y Estilos -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">


</head>

<style>
    @keyframes shake {

        0%,
        100% {
            transform: translateX(0);
        }

        10%,
        30%,
        50%,
        70%,
        90% {
            transform: translateX(-5px);
        }

        20%,
        40%,
        60%,
        80% {
            transform: translateX(5px);
        }
    }

    .pin-btn {
        padding: 25px;
        font-size: 24px;
        background: #4a5568;
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .pin-btn:hover {
        transform: scale(1.05);
        background: #5a6578;
    }
</style>

<body>
    <div class="container">
        <div class="tabs">
            <button class="tab-button" onclick="showTab('mesas', this)">ü™ë Control de Mesas</button>
            <button class="tab-button" onclick="showTab('pedidos', this)">üìã Registro de Pedidos</button>
            <button class="tab-button" onclick="showTab('inventario', this)">üì¶ Gesti√≥n de Inventario</button>
            <button class="tab-button" onclick="showTab('facturacion', this)">üí∞ Facturaci√≥n</button>
            <button class="tab-button" onclick="showTab('configuracion', this)">‚öôÔ∏è Configuraci√≥n</button>
            <button class="tab-button" onclick="showTab('usuarios', this)">üë§ Usuarios</button>
        </div>

        <!-- Tab Mesas -->
        <div id="mesas" class="tab-content active">
            <h2>Control de Mesas</h2>

            <!-- Pesta√±as de √°reas para mesas -->
            <div id="areasMesasTabs" class="areas-mesas-tabs">
                <!-- Se llenar√°n din√°micamente -->
            </div>

            <!-- Controles de paginaci√≥n superior -->
            <div class="mesas-paginacion-top">
                <button class="btn-pagina-mesa" onclick="paginaAnteriorMesas()" id="btnPrevMesas">
                    ‚óÄ ANTERIOR
                </button>
                <div class="indicador-pagina-mesa">
                    <span id="paginaActualMesas">1</span> / <span id="totalPaginasMesas">1</span>
                </div>
                <button class="btn-pagina-mesa" onclick="paginaSiguienteMesas()" id="btnNextMesas">
                    SIGUIENTE ‚ñ∂
                </button>
            </div>

            <!-- Grid de mesas sin scroll -->
            <div class="mesas-grid-container">
                <div class="mesas-grid-tpv" id="mesasGrid"></div>
            </div>

            <!-- Indicador de puntos de p√°gina -->
            <div class="mesas-dots" id="mesasDots"></div>
        </div>

        <!-- Tab Gesti√≥n de Inventario -->
        <div id="inventario" class="tab-content">
            <h2>üì¶ Gesti√≥n de Inventario</h2>

            <!-- Resumen de Alertas -->
            <div id="alertasInventario" style="margin-bottom: 25px;"></div>

            <!-- Filtros y B√∫squeda -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 25px;">
                <h3 style="color: #ffa502; margin-bottom: 15px;">üîç Filtros y B√∫squeda</h3>
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">üîç Buscar producto:</label>
                        <input type="text" id="buscarProducto" placeholder="Nombre del producto..."
                            oninput="filtrarInventario()"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">üìä Estado del stock:</label>
                        <select id="filtroStock" onchange="filtrarInventario()"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            <option value="todos">Todos los productos</option>
                            <option value="normal">Stock normal</option>
                            <option value="bajo">Stock bajo</option>
                            <option value="agotado">Sin stock</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">üè¢ √Årea:</label>
                        <select id="filtroArea" onchange="filtrarInventario()"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            <!-- Se llenar√° din√°micamente -->
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">üìÇ Categor√≠a:</label>
                        <select id="filtroCategoria" onchange="filtrarInventario()"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            <!-- Se llenar√° din√°micamente -->
                        </select>
                    </div>
                    <button class="btn-warning" onclick="limpiarFiltrosInventario()">üîÑ Limpiar</button>
                </div>
            </div>

            <!-- Acciones R√°pidas -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 25px;">
                <h3 style="color: #ffa502; margin-bottom: 15px;">‚ö° Acciones R√°pidas</h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <button class="btn-success" onclick="abrirModalReabastecimiento()">üìà Reabastecer Todo</button>
                    <button class="btn-warning" onclick="exportarInventarioCSV()">üì• Exportar Inventario</button>
                    <button class="btn-primary" onclick="mostrarHistorialMovimientos()">üìã Historial de
                        Movimientos</button>
                    <button class="btn-primary" onclick="abrirModalAjusteStock()">‚öñÔ∏è Ajuste Manual</button>
                </div>
            </div>

            <!-- Lista de Productos del Inventario -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <h3 style="color: #ffa502; margin-bottom: 20px;">üì¶ Productos en Inventario</h3>
                <div id="listaInventario" style="max-height: 600px; overflow-y: auto;"></div>
            </div>
        </div>

        <!-- Tab Facturaci√≥n -->
        <div id="facturacion" class="tab-content">
            <h2>Resumen de Facturaci√≥n</h2>

            <!-- Comparativas Pro/Premium -->
            <div id="comparativasProPremium" style="display: none;">
                <div
                    style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 165, 2, 0.1)); border: 2px solid rgba(255, 165, 2, 0.3); padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                    <h3 style="color: #ffa502; margin-bottom: 25px; text-align: center; font-size: 1.4em;">üìä An√°lisis
                        Comparativo Avanzado</h3>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                        <!-- Hoy vs Ayer -->
                        <div
                            style="background: rgba(30, 30, 30, 0.95); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -20px; right: -20px; font-size: 80px; opacity: 0.05;">
                                üí∞</div>
                            <h4 style="color: #888; margin-bottom: 15px; font-size: 1em;">HOY vs AYER</h4>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="color: #ffa502; font-size: 1.8em; font-weight: bold;" id="ventasHoy">‚Ç¨0.00
                                </div>
                                <div style="color: #666; font-size: 1em;" id="ventasAyer">‚Ç¨0.00</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span id="tendenciaHoy" style="font-size: 1.2em;">‚Üí</span>
                                <span id="porcentajeHoy" style="font-weight: bold;">0%</span>
                                <span style="color: #888; font-size: 0.9em;">vs ayer</span>
                            </div>
                        </div>

                        <!-- Semana vs Anterior -->
                        <div
                            style="background: rgba(30, 30, 30, 0.95); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -20px; right: -20px; font-size: 80px; opacity: 0.05;">
                                üìÖ</div>
                            <h4 style="color: #888; margin-bottom: 15px; font-size: 1em;">ESTA SEMANA vs ANTERIOR</h4>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="color: #ffa502; font-size: 1.8em; font-weight: bold;"
                                    id="ventasSemanaActual">‚Ç¨0.00</div>
                                <div style="color: #666; font-size: 1em;" id="ventasSemanaAnterior">‚Ç¨0.00</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span id="tendenciaSemana" style="font-size: 1.2em;">‚Üí</span>
                                <span id="porcentajeSemana" style="font-weight: bold;">0%</span>
                                <span style="color: #888; font-size: 0.9em;">vs anterior</span>
                            </div>
                        </div>

                        <!-- Mes vs Anterior -->
                        <div
                            style="background: rgba(30, 30, 30, 0.95); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -20px; right: -20px; font-size: 80px; opacity: 0.05;">
                                üìà</div>
                            <h4 style="color: #888; margin-bottom: 15px; font-size: 1em;">ESTE MES vs ANTERIOR</h4>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="color: #ffa502; font-size: 1.8em; font-weight: bold;" id="ventasMesActual">
                                    ‚Ç¨0.00</div>
                                <div style="color: #666; font-size: 1em;" id="ventasMesAnterior">‚Ç¨0.00</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span id="tendenciaMes" style="font-size: 1.2em;">‚Üí</span>
                                <span id="porcentajeMes" style="font-weight: bold;">0%</span>
                                <span style="color: #888; font-size: 0.9em;">vs anterior</span>
                            </div>
                        </div>

                        <!-- A√±o vs Anterior -->
                        <div
                            style="background: rgba(30, 30, 30, 0.95); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative; overflow: hidden;">
                            <div style="position: absolute; top: -20px; right: -20px; font-size: 80px; opacity: 0.05;">
                                üèÜ</div>
                            <h4 style="color: #888; margin-bottom: 15px; font-size: 1em;">ESTE A√ëO vs ANTERIOR</h4>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="color: #ffa502; font-size: 1.8em; font-weight: bold;" id="ventasA√±oActual">
                                    ‚Ç¨0.00</div>
                                <div style="color: #666; font-size: 1em;" id="ventasA√±oAnterior">‚Ç¨0.00</div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span id="tendenciaA√±o" style="font-size: 1.2em;">‚Üí</span>
                                <span id="porcentajeA√±o" style="font-weight: bold;">0%</span>
                                <span style="color: #888; font-size: 0.9em;">vs anterior</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Gr√°ficos Interactivos Pro/Premium -->
            <div id="graficosProPremium" style="display: none;">
                <div
                    style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.1)); border: 2px solid rgba(34, 197, 94, 0.3); padding: 25px; border-radius: 20px; margin-bottom: 30px;">
                    <h3 style="color: #22c55e; margin-bottom: 25px; text-align: center; font-size: 1.4em;">üìä An√°lisis
                        Visual Avanzado</h3>

                    <!-- Filtros de gr√°ficos -->
                    <div
                        style="background: rgba(20, 20, 20, 0.8); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; align-items: center;">
                            <div>
                                <label style="color: #888; font-size: 0.9em;">üìÖ Per√≠odo:</label>
                                <select id="periodoGrafico" onchange="actualizarGraficos()"
                                    style="width: 100%; padding: 8px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: white; font-size: 14px;">
                                    <option value="7">√öltimos 7 d√≠as</option>
                                    <option value="30" selected>√öltimos 30 d√≠as</option>
                                    <option value="90">√öltimos 90 d√≠as</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: #888; font-size: 0.9em;">üìä Tipo:</label>
                                <select id="tipoGrafico" onchange="cambiarTipoGrafico()"
                                    style="width: 100%; padding: 8px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: white; font-size: 14px;">
                                    <option value="lineas">üìà L√≠neas</option>
                                    <option value="barras">üìä Barras</option>
                                    <option value="area">üìä √Årea</option>
                                </select>
                            </div>
                            <div>
                                <label style="color: #888; font-size: 0.9em;">üîç Ver por:</label>
                                <select id="tipoAgrupacion" onchange="cambiarAgrupacion()"
                                    style="width: 100%; padding: 8px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 6px; color: white; font-size: 14px;">
                                    <option value="categoria">üìÇ Categor√≠as</option>
                                    <option value="area">üè¢ √Åreas</option>
                                </select>
                            </div>
                            <button class="btn-primary" onclick="actualizarGraficos()"
                                style="padding: 8px 15px; font-size: 14px;">üîÑ Actualizar</button>
                            <button class="btn-success" onclick="exportarGraficos()"
                                style="padding: 8px 15px; font-size: 14px;">üì• Exportar</button>
                            <button class="btn-warning" onclick="reiniciarGraficos()"
                                style="padding: 8px 15px; font-size: 14px;">üîÑ Recargar Gr√°ficos</button>

                        </div>
                    </div>

                    <!-- Grid de gr√°ficos -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <!-- Gr√°fico principal - Ventas por tiempo -->
                        <div
                            style="background: rgba(20, 20, 20, 0.95); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #22c55e; margin-bottom: 15px; text-align: center;">üìà Evoluci√≥n de Ventas
                            </h4>
                            <div style="position: relative; height: 300px;">
                                <canvas id="graficoVentasLineas"></canvas>
                            </div>
                        </div>

                        <!-- Gr√°fico circular - Por categor√≠as -->
                        <div
                            style="background: rgba(20, 20, 20, 0.95); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #22c55e; margin-bottom: 15px; text-align: center;">ü•ß Ventas por Categor√≠a
                            </h4>
                            <div style="position: relative; height: 300px;">
                                <canvas id="graficoVentasCategorias"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Gr√°ficos adicionales -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <!-- Gr√°fico por horas -->
                        <div
                            style="background: rgba(20, 20, 20, 0.95); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #22c55e; margin-bottom: 15px; text-align: center;">‚è∞ Ventas por Hora</h4>
                            <div style="position: relative; height: 250px;">
                                <canvas id="graficoVentasHoras"></canvas>
                            </div>
                        </div>

                        <!-- Top productos -->
                        <div
                            style="background: rgba(20, 20, 20, 0.95); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <h4 style="color: #22c55e; margin-bottom: 15px; text-align: center;">üèÜ Top Productos</h4>
                            <div style="position: relative; height: 250px;">
                                <canvas id="graficoTopProductos"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- M√©tricas r√°pidas -->
                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div
                            style="background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); padding: 15px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #22c55e; margin-bottom: 5px;">üìä Pico de Ventas</h4>
                            <div id="picoVentas" style="font-size: 1.4em; font-weight: bold; color: #fff;">-</div>
                            <div id="horaPico" style="color: #888; font-size: 0.9em;">-</div>
                        </div>
                        <div
                            style="background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); padding: 15px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #22c55e; margin-bottom: 5px;">‚≠ê Producto Estrella</h4>
                            <div id="productoEstrella" style="font-size: 1.4em; font-weight: bold; color: #fff;">-</div>
                            <div id="ventasEstrella" style="color: #888; font-size: 0.9em;">-</div>
                        </div>
                        <div
                            style="background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); padding: 15px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #22c55e; margin-bottom: 5px;">ü™ë Mesa Top</h4>
                            <div id="mesaTop" style="font-size: 1.4em; font-weight: bold; color: #fff;">-</div>
                            <div id="facturaci√≥nMesaTop" style="color: #888; font-size: 0.9em;">-</div>
                        </div>
                        <div
                            style="background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); padding: 15px; border-radius: 10px; text-align: center;">
                            <h4 style="color: #22c55e; margin-bottom: 5px;">üí∞ Ticket Promedio</h4>
                            <div id="ticketPromedio" style="font-size: 1.4em; font-weight: bold; color: #fff;">-</div>
                            <div id="totalTickets" style="color: #888; font-size: 0.9em;">-</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Stats Grid Original (para Standard) -->
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>üí∞ Hoy</h4>
                    <div class="value" id="facturacionHoy">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <h4>üìÖ Esta Semana</h4>
                    <div class="value" id="facturacionSemana">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <h4>üìà Este Mes</h4>
                    <div class="value" id="facturacionMes">‚Ç¨0.00</div>
                </div>
                <div class="stat-card">
                    <h4>üìä <span id="nombreTrimestre">Este Trimestre</span></h4>
                    <div class="value" id="facturacionTrimestre">‚Ç¨0.00</div>
                </div>
            </div>

            <h3>üìä Detalle Diario</h3>
            <table class="facturacion-table">
                <thead>
                    <tr>
                        <th>D√≠a</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody id="facturacionDiaria"></tbody>
            </table>

            <h3>üìà Resumen Semanal</h3>
            <table class="facturacion-table">
                <thead>
                    <tr>
                        <th>Semana</th>
                        <th>Total</th>
                    </tr>
                </thead>
                <tbody id="facturacionSemanal"></tbody>
            </table>
        </div>

        <!-- Tab Configuraci√≥n -->
        <div id="configuracion" class="tab-content">
            <h2>Configuraci√≥n del Sistema</h2>

            <div style="margin: 30px 0;">
                <h3>üì¶ Gesti√≥n de Productos</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h4 style="color: #ffa502; margin-bottom: 20px;">‚ûï Agregar Nuevo Producto</h4>

                    <div style="display: flex; flex-direction: column; gap: 20px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">Nombre:</label>
                                <input type="text" id="nuevoNombre" placeholder="Nombre del producto"
                                    style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">Precio (‚Ç¨):</label>
                                <input type="number" id="nuevoPrecio" placeholder="0.00" step="0.10" min="0"
                                    style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">Categor√≠a: <span
                                        style="color: #ff6b6b;">*</span></label>
                                <select id="nuevaCategoria"
                                    style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                                    <!-- Se llenar√° din√°micamente -->
                                </select>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr 150px 150px; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">√Årea (opcional):</label>
                                <select id="nuevaArea"
                                    style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                                    <!-- Se llenar√° din√°micamente -->
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">Visual del
                                    Producto:</label>
                                <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                                    <button type="button" onclick="toggleSelectorVisual('emoji')" id="btnEmoji"
                                        style="padding: 8px 12px; background: #4a5568; border: none; border-radius: 5px; color: white; cursor: pointer;">üòÄ
                                        Emoji</button>
                                    <button type="button" onclick="toggleSelectorVisual('imagen')" id="btnImagen"
                                        style="padding: 8px 12px; background: #2d3748; border: none; border-radius: 5px; color: white; cursor: pointer;">üñºÔ∏è
                                        Imagen</button>
                                </div>

                                <div id="selectorEmoji" style="display: block;">
                                    <input type="text" id="nuevoEmoji" value="üçΩÔ∏è" readonly
                                        style="width: 80px; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; text-align: center;
                                                                                font-size: 24px; cursor: pointer; margin-bottom: 10px;">
                                    <div
                                        style="display: flex; flex-wrap: wrap; gap: 5px; padding: 10px; background: rgba(30, 30, 30, 0.9); border-radius: 8px; max-height: 100px; overflow-y: auto;">
                                        <span onclick="seleccionarEmoji('‚òï', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Caf√©">‚òï</span>
                                        <span onclick="seleccionarEmoji('ü•§', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Refresco">ü•§</span>
                                        <span onclick="seleccionarEmoji('üç∫', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Cerveza">üç∫</span>
                                        <span onclick="seleccionarEmoji('üç∑', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Vino">üç∑</span>
                                        <span onclick="seleccionarEmoji('üçπ', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="C√≥ctel">üçπ</span>
                                        <span onclick="seleccionarEmoji('ü•É', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Licor">ü•É</span>
                                        <span onclick="seleccionarEmoji('üçû', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Pan">üçû</span>
                                        <span onclick="seleccionarEmoji('ü•™', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Bocadillo">ü•™</span>
                                        <span onclick="seleccionarEmoji('üçî', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Hamburguesa">üçî</span>
                                        <span onclick="seleccionarEmoji('üçï', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Pizza">üçï</span>
                                        <span onclick="seleccionarEmoji('ü•ó', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Ensalada">ü•ó</span>
                                        <span onclick="seleccionarEmoji('üç∞', this)"
                                            style="cursor: pointer; padding: 5px; font-size: 24px; border-radius: 5px; background: rgba(255,255,255,0.05); transition: all 0.3s ease;"
                                            title="Postre">üç∞</span>
                                    </div>
                                </div>

                                <div id="selectorImagen" style="display: none;">
                                    <input type="file" id="nuevoImagenFile" accept="image/*"
                                        onchange="previewImagen(event)" style="display: none;">
                                    <button type="button" onclick="document.getElementById('nuevoImagenFile').click()"
                                        style="padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; cursor: pointer;">
                                        üì∑ Seleccionar Imagen
                                    </button>
                                    <div id="previewImagenContainer" style="margin-top: 10px;">
                                        <img id="previewImagen" src="" alt="Preview"
                                            style="max-width: 80px; max-height: 80px; border-radius: 8px; display: none;">
                                    </div>
                                    <input type="hidden" id="nuevoImagen" value="">
                                </div>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px; color: #888;">
                                    <input type="checkbox" id="nuevoControlStock" checked onchange="toggleStockFields()"
                                        style="margin-right: 8px; width: 18px; height: 18px; vertical-align: middle;">
                                    <span style="vertical-align: middle;">üì¶ Controlar Stock</span>
                                </label>
                                <div id="camposStock"
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                                    <div>
                                        <label
                                            style="display: block; margin-bottom: 5px; color: #888; font-size: 0.9em;">Stock
                                            actual:</label>
                                        <input type="number" id="nuevoStock" placeholder="50" min="0"
                                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                                    </div>
                                    <div>
                                        <label
                                            style="display: block; margin-bottom: 5px; color: #888; font-size: 0.9em;">Stock
                                            m√≠nimo:</label>
                                        <input type="number" id="nuevoStockMinimo" placeholder="10" min="0"
                                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                                    </div>
                                </div>
                                <div id="sinStockInfo"
                                    style="display: none; padding: 10px; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 8px; margin-top: 10px;">
                                    <p style="color: #22c55e; margin: 0; font-size: 0.9em;">
                                        ‚úÖ Producto ilimitado - No se controlar√° el stock
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center;">
                            <button class="btn-success" onclick="agregarNuevoProducto()" style="padding: 12px 30px;">‚ûï
                                Agregar Producto</button>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <h4 style="color: #ffa502; margin-bottom: 15px;">üìã Productos Actuales</h4>
                        <div id="listaProductos"
                            style="max-height: 400px; overflow-y: auto; background: rgba(30, 30, 30, 0.9); border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin: 30px 0;">
                <h3>ü™ë Gesti√≥n de Mesas</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4 style="color: #ffa502; margin: 0;">üìã Mesas Actuales</h4>
                        <button class="btn-success" onclick="abrirModalCrearMesa()">‚ûï Agregar Mesa</button>
                    </div>
                    <div id="listaMesas"
                        style="max-height: 300px; overflow-y: auto; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de Categor√≠as -->
            <div style="margin: 30px 0;">
                <h3>üè∑Ô∏è Gesti√≥n de Categor√≠as</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">

                    <!-- Agregar nueva categor√≠a -->
                    <div style="display: flex; gap: 15px; align-items: end; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 5px; color: #888;">Nueva Categor√≠a:</label>
                            <input type="text" id="nuevaCategoriaNombre" placeholder="Nombre de la categor√≠a"
                                style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                        </div>
                        <button class="btn-success" onclick="agregarCategoria()">‚ûï Agregar</button>
                    </div>

                    <!-- Lista de categor√≠as -->
                    <div id="listaCategorias" style="max-height: 200px; overflow-y: auto;">
                        <!-- Las categor√≠as se cargar√°n aqu√≠ din√°micamente -->
                    </div>
                </div>
            </div>

            <!-- Gesti√≥n de √Åreas -->
            <div style="margin: 30px 0;">
                <h3>üè¢ Gesti√≥n de √Åreas</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">

                    <!-- Agregar nueva √°rea -->
                    <div style="display: flex; gap: 15px; align-items: end; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 5px; color: #888;">Nueva √Årea:</label>
                            <input type="text" id="nuevaAreaNombre" placeholder="Nombre del √°rea (ej: Terraza Jard√≠n)"
                                style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                        </div>
                        <button class="btn-success" onclick="agregarArea()">‚ûï Agregar</button>
                    </div>

                    <!-- Lista de √°reas -->
                    <div id="listaAreas" style="max-height: 200px; overflow-y: auto;">
                        <!-- Las √°reas se cargar√°n aqu√≠ din√°micamente -->
                    </div>
                </div>
            </div>

            <div style="margin: 30px 0;">
                <h3>üíæ Gesti√≥n de Datos</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px;">
                    <button class="btn-success" onclick="exportarDatos()">üì• Exportar Datos</button>
                    <button class="btn-warning" onclick="document.getElementById('importFile').click()">üì§ Importar
                        Datos</button>
                    <input type="file" id="importFile" style="display: none;" onchange="importarDatos(event)">
                    <button class="btn-danger"
                        onclick="if(confirm('¬øEst√°s seguro? Esto borrar√° todos los datos.')) limpiarTodo()">üóëÔ∏è Limpiar
                        Todo</button>
                </div>
            </div>

            <div style="margin: 30px 0;">
                <h3>üîÑ Backup Autom√°tico</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <p style="margin-bottom: 10px;">‚úÖ Los datos se guardan autom√°ticamente en tu navegador.</p>
                    <p>‚è∞ √öltima actualizaci√≥n: <strong><span id="ultimaActualizacion">-</span></strong></p>
                </div>
            </div>

            <div style="margin: 30px 0;">
                <h3>‚å®Ô∏è Configuraci√≥n de Teclado</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div
                        style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                        <div>
                            <h4 style="color: #ffa502; margin-bottom: 5px;">Teclado T√°ctil Virtual</h4>
                            <p style="color: #888; font-size: 0.9em; margin: 0;">
                                Activa esta opci√≥n para usar un teclado en pantalla en dispositivos t√°ctiles.
                                Ideal para tablets y TPV t√°ctiles.
                            </p>
                        </div>
                        <label class="switch" style="margin-left: 20px;">
                            <input type="checkbox" id="toggleTecladoVirtual" onchange="toggleTecladoVirtual()">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div id="estadoTecladoVirtual"
                        style="padding: 10px; background: rgba(40, 40, 40, 0.5); border-radius: 8px; text-align: center;">
                        <span id="textoEstadoTeclado">üî¥ Teclado Virtual Desactivado</span>
                    </div>
                    <div
                        style="margin-top: 15px; padding: 15px; background: rgba(255, 165, 2, 0.1); border: 1px solid rgba(255, 165, 2, 0.3); border-radius: 8px;">
                        <p style="color: #ffa502; margin: 0; font-size: 0.85em;">
                            <strong>üí° Tip:</strong> Si usas un dispositivo con teclado f√≠sico, mant√©n esta opci√≥n
                            desactivada.
                            Si usas una tablet o pantalla t√°ctil, act√≠vala para facilitar la entrada de datos.
                        </p>
                    </div>
                </div>
            </div>


            <div style="margin: 30px 0;">
                <h3>üîê Administraci√≥n</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <p style="color: #888; margin-bottom: 15px;">
                        Acceso a funciones administrativas y gesti√≥n de licencias
                    </p>
                    <button class="btn-warning" onclick="abrirPanelAdmin()" style="padding: 12px 30px;">
                        üîë Panel de Administraci√≥n
                    </button>
                </div>
            </div>


            <!-- Panel de Administraci√≥n Simplificado -->
            <div id="panelAdmin" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 600px;">
                    <span class="close" onclick="cerrarPanelAdmin()">&times;</span>
                    <h2 style="color: #ffa502; text-align: center; margin-bottom: 30px;">
                        üîê Panel de Administraci√≥n
                    </h2>

                    <!-- Gesti√≥n de Licencias -->
                    <div
                        style="background: rgba(40, 40, 40, 0.9); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                        <h3 style="color: #fff; margin-bottom: 15px;">üìú Gesti√≥n de Licencias</h3>

                        <!-- Estado Actual -->
                        <div id="estadoLicenciaAdmin"
                            style="background: rgba(30, 30, 30, 0.9); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <p style="color: #888; margin: 0;">Cargando estado...</p>
                        </div>

                        <!-- Activar Licencia -->
                        <div style="margin-top: 15px;">
                            <label style="display: block; margin-bottom: 5px; color: #888;">Introducir c√≥digo de
                                licencia:</label>
                            <input type="text" id="codigoLicenciaAdmin" placeholder="XXXX-XXXX-XXXX-XXXX"
                                style="width: 100%; padding: 12px; background: rgba(30, 30, 30, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-family: monospace; text-align: center; margin-bottom: 10px;">

                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <button class="btn-primary" onclick="activarLicenciaAdmin('standard')"
                                    style="padding: 12px; font-weight: bold;">
                                    üìã Standard
                                </button>
                                <button class="btn-warning" onclick="activarLicenciaAdmin('pro')"
                                    style="padding: 12px; font-weight: bold;">
                                    üöÄ Pro
                                </button>
                                <button class="btn-success" onclick="activarLicenciaAdmin('premium')"
                                    style="padding: 12px; font-weight: bold;">
                                    üëë Premium
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Mantenimiento -->
                    <div style="background: rgba(40, 40, 40, 0.9); padding: 20px; border-radius: 15px;">
                        <h3 style="color: #fff; margin-bottom: 15px;">üîß Mantenimiento</h3>

                        <div style="display: grid; gap: 10px;">
                            <button class="btn-warning" onclick="limpiarCacheSeguro()">
                                üîÑ Actualizar Cach√© (Seguro)
                            </button>
                            <button class="btn-danger" onclick="resetearDatos()">
                                üóëÔ∏è Resetear Todos los Datos
                            </button>
                            <button id="btnInstalarPWA"
                                style="display: none; background: #22c55e; color: white; padding: 15px 25px; border: none; border-radius: 10px; font-size: 16px; margin: 10px;">
                                üì± Instalar como App
                            </button>
                            <button class="btn-primary" onclick="exportarDatosAdmin()">
                                üíæ Exportar Backup222
                            </button>


                        </div>

                        <div
                            style="margin-top: 15px; padding: 10px; background: rgba(255, 165, 2, 0.1); border: 1px solid rgba(255, 165, 2, 0.3); border-radius: 8px;">
                            <p style="color: #ffa502; margin: 0; font-size: 0.85em;">
                                ‚ö†Ô∏è Usa estas opciones con cuidado. Se recomienda hacer backup antes.
                            </p>
                        </div>
                    </div>

                    <!-- Bot√≥n Cerrar -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="btn-primary" onclick="cerrarPanelAdmin()" style="padding: 12px 40px;">
                            Cerrar Panel
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Tab Usuarios -->
        <div id="usuarios" class="tab-content">
            <h2>üë• Gesti√≥n de Usuarios</h2>

            <!-- Secci√≥n de Login -->
            <div style="margin: 30px 0;">
                <h3>üîê Iniciar Sesi√≥n</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div id="loginSection" style="text-align: center;">
                        <div id="estadoSesion"
                            style="margin-bottom: 20px; padding: 15px; background: rgba(40, 40, 40, 0.9); border-radius: 10px;">
                            <!-- Se actualiza din√°micamente -->
                        </div>
                        <button class="btn-primary" onclick="mostrarFormularioLogin()" id="btnIniciarSesion"
                            style="padding: 15px 40px; font-size: 18px;">
                            üîê Iniciar Sesi√≥n
                        </button>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n de Crear Usuario (solo visible para due√±o) -->
            <div id="seccionCrearUsuario" style="margin: 30px 0; display: none;">
                <h3>‚ûï Crear Nuevo Usuario</h3>
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; align-items: end;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #888;">Nombre:</label>
                            <input type="text" id="nuevoUsuarioNombre" placeholder="Ej: JUAN"
                                style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #888;">PIN (4 d√≠gitos):</label>
                            <input type="text" id="nuevoUsuarioPin" placeholder="1234" maxlength="4"
                                style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; text-align: center;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; color: #888;">Rol:</label>
                            <select id="nuevoUsuarioRol"
                                style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                                <option value="camarero">üçΩÔ∏è Camarero</option>
                                <option value="encargado">üëî Encargado</option>
                                <option value="due√±o">üëë Due√±o</option>
                            </select>
                        </div>
                        <button class="btn-success" onclick="agregarUsuario()">‚ûï Agregar Usuario</button>
                    </div>
                </div>
            </div>

            <!-- Lista de Usuarios (solo visible para due√±o) -->
            <div id="seccionListaUsuarios" style="margin: 30px 0; display: none;">
                <h3>üìã Usuarios Actuales</h3>
                <div id="listaUsuarios"
                    style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); max-height: 400px; overflow-y: auto;">
                </div>
            </div>
        </div>
        <!-- Tab Pedidos -->
        <div id="pedidos" class="tab-content">
            <h2>üìã Registro de Pedidos por Hora</h2>

            <!-- Filtros -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 25px;">
                <h3 style="color: #ffa502; margin-bottom: 15px;">üîç Filtros</h3>
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; align-items: end;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">üìÖ Fecha:</label>
                        <input type="date" id="filtroFecha"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">ü™ë Mesa:</label>
                        <select id="filtroMesa"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                            <option value="">Todas las mesas</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">‚è∞ Hora desde:</label>
                        <input type="time" id="filtroHoraDesde"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; color: #888;">‚è∞ Hora hasta:</label>
                        <input type="time" id="filtroHoraHasta"
                            style="width: 100%; padding: 10px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white;">
                    </div>
                    <button class="btn-primary" onclick="aplicarFiltrosPedidos()">üîç Filtrar</button>
                    <button class="btn-warning" onclick="limpiarFiltrosPedidos()">üîÑ Limpiar</button>
                </div>
            </div>

            <!-- Panel de B√∫squeda Avanzada (Premium) -->
            <div id="panelBusquedaAvanzada"></div>

            <!-- Estad√≠sticas por hora -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); margin-bottom: 25px;">
                <h3 style="color: #ffa502; margin-bottom: 15px;">üìä Resumen por Hora</h3>
                <div id="estadisticasHora"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                </div>
            </div>

            <!-- Lista de pedidos -->
            <div
                style="background: rgba(30, 30, 30, 0.9); padding: 20px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #ffa502; margin: 0;">üìù Pedidos Detallados</h3>
                    <button class="btn-success" onclick="exportarPedidosCSV()">üì• Exportar CSV</button>
                </div>
                <div id="listaPedidos" style="max-height: 500px; overflow-y: auto;"></div>
            </div>
        </div>

    </div>

    <!-- MODALES -->

    <!-- Modal para crear/editar mesa -->
    <div id="gestionMesaModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="cerrarModalGestionMesa()">&times;</span>
            <h2 id="tituloModalMesa" style="margin-bottom: 25px; color: #fff;">ü™ë Crear Mesa</h2>

            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Nombre/N√∫mero:</label>
                    <input type="text" id="gestionMesaNombre" placeholder="Ej: Mesa 1, VIP, Terraza A..."
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Capacidad:</label>
                    <input type="number" id="gestionMesaCapacidad" placeholder="4" min="1" max="20"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Descripci√≥n (opcional):</label>
                    <textarea id="gestionMesaDescripcion" placeholder="Ej: Mesa junto a la ventana, Mesa VIP..."
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px; min-height: 80px; resize: vertical;"></textarea>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">üìç √Årea:</label>
                    <select id="gestionMesaArea"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                        <!-- Se llenar√° din√°micamente -->
                    </select>
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-success" onclick="guardarGestionMesa()">üíæ Guardar</button>
                <button class="btn-primary" onclick="cerrarModalGestionMesa()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal para gestionar mesa -->
    <div id="mesaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="cerrarModal()">&times;</span>
            <h2 id="mesaTitulo" style="margin-bottom: 15px; color: #fff; text-align: center;">Mesa</h2>

            <!-- Pesta√±as de categor√≠as -->
            <div id="categoriasTabs" class="categorias-tabs">
                <!-- Se llenar√°n din√°micamente -->
            </div>

            <!-- Contenedor principal con 2 columnas -->
            <div class="modal-body">
                <!-- Columna izquierda - Productos -->
                <div class="productos-section">
                    <!-- Controles de paginaci√≥n superior -->
                    <div class="productos-paginacion-top">
                        <button class="btn-pagina-categoria" onclick="paginaAnteriorCategoria()" id="btnPrevCategoria">
                            ‚óÄ ANTERIOR
                        </button>
                        <div class="indicador-pagina">
                            <span id="paginaActualCategoria">1</span> / <span id="totalPaginasCategoria">1</span>
                        </div>
                        <button class="btn-pagina-categoria" onclick="paginaSiguienteCategoria()" id="btnNextCategoria">
                            SIGUIENTE ‚ñ∂
                        </button>
                    </div>

                    <!-- Grid de productos sin scroll -->
                    <div class="productos-grid-container">
                        <div class="productos-grid" id="productosGrid"></div>
                    </div>

                    <!-- Indicador de puntos de p√°gina -->
                    <div class="productos-dots" id="productsDots"></div>
                </div>

                <!-- Columna derecha - Ticket -->
                <div class="ticket-section">
                    <div class="ticket" id="ticketActual">
                        <h3>üßæ TICKET ACTUAL</h3>
                        <div id="ticketItems"></div>
                        <div class="total" id="totalMesa">Total: ‚Ç¨0.00</div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center; flex-shrink: 0;">
                <button class="btn-success" onclick="cobrarMesa()">üí∞ Cobrar Mesa</button>
                <button class="btn-danger" onclick="limpiarMesa()">üóëÔ∏è Limpiar Mesa</button>
                <button class="btn-primary" onclick="cerrarModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal para editar producto -->
    <div id="editarProductoModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="cerrarModalEditarProducto()">&times;</span>
            <h2 style="margin-bottom: 25px; color: #fff;">‚úèÔ∏è Editar Producto</h2>

            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Nombre:</label>
                    <input type="text" id="editarNombre" placeholder="Nombre del producto"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Precio (‚Ç¨):</label>
                    <input type="number" id="editarPrecio" placeholder="0.00" step="0.10" min="0"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">Emoji:</label>
                    <input type="text" id="editarEmoji" placeholder="üçΩÔ∏è" maxlength="2"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px; text-align: center;">
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-success" onclick="guardarEdicionProducto()">üíæ Guardar Cambios</button>
                <button class="btn-primary" onclick="cerrarModalEditarProducto()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Ajuste de Stock Individual -->
    <div id="modalAjusteStock" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="cerrarModalAjusteStock()">&times;</span>
            <h2 id="tituloAjusteStock" style="margin-bottom: 25px; color: #fff;">üì¶ Ajustar Stock</h2>

            <div id="infoProductoAjuste"
                style="background: rgba(255, 107, 107, 0.1); border: 1px solid rgba(255, 107, 107, 0.3); padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                <h3 id="nombreProductoAjuste" style="color: #fff; margin: 0;"></h3>
                <p id="stockActualAjuste"
                    style="color: #ffa502; margin: 5px 0 0 0; font-size: 1.2em; font-weight: bold;"></p>
            </div>

            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">üìä Tipo de ajuste:</label>
                    <select id="tipoAjuste" onchange="toggleCamposAjuste()"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                        <option value="establecer">üìå Establecer cantidad exacta</option>
                        <option value="agregar">‚ûï Agregar al stock actual</option>
                        <option value="reducir">‚ûñ Reducir del stock actual</option>
                    </select>
                </div>

                <div>
                    <label id="labelCantidad" style="display: block; margin-bottom: 5px; color: #888;">üì¶ Nueva
                        cantidad:</label>
                    <input type="number" id="cantidadAjuste" placeholder="0" min="0"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>

                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">üìù Motivo (opcional):</label>
                    <textarea id="motivoAjuste" placeholder="Ej: Rotura, Caducidad, Inventario f√≠sico..."
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px; min-height: 80px; resize: vertical;"></textarea>
                </div>

                <div id="previsualizacionAjuste"
                    style="background: rgba(30, 30, 30, 0.9); padding: 15px; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <h4 style="color: #ffa502; margin-bottom: 10px;">üëÅÔ∏è Previsualizaci√≥n:</h4>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #888;">Stock actual:</span>
                        <span id="stockPrevioAjuste" style="color: #fff;">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                        <span style="color: #888;">Stock resultante:</span>
                        <span id="stockResultanteAjuste" style="color: #22c55e; font-weight: bold;">0</span>
                    </div>
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-success" onclick="confirmarAjusteStock()">üíæ Confirmar Ajuste</button>
                <button class="btn-primary" onclick="cerrarModalAjusteStock()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Reabastecimiento Masivo -->
    <div id="modalReabastecimiento" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="cerrarModalReabastecimiento()">&times;</span>
            <h2 style="margin-bottom: 25px; color: #fff;">üìà Reabastecimiento Masivo</h2>

            <div
                style="background: rgba(255, 107, 107, 0.1); border: 1px solid rgba(255, 107, 107, 0.3); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <h4 style="color: #ffa502; margin-bottom: 10px;">‚ÑπÔ∏è Informaci√≥n</h4>
                <p style="color: #e0e0e0; margin: 0;">Esta acci√≥n reabastecer√° todos los productos que est√©n por
                    debajo
                    de su stock m√≠nimo hasta alcanzar una cantidad objetivo.</p>
            </div>

            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">üéØ Cantidad objetivo:</label>
                    <input type="number" id="cantidadObjetivo" placeholder="50" min="1" value="50"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                    <small style="color: #888;">Se establecer√° esta cantidad para todos los productos con stock
                        bajo</small>
                </div>

                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888;">üìù Motivo:</label>
                    <input type="text" id="motivoReabastecimiento"
                        placeholder="Ej: Reposici√≥n semanal, Pedido a proveedor..." value="Reabastecimiento autom√°tico"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                </div>

                <div id="productosAReabastecer"
                    style="background: rgba(30, 30, 30, 0.9); padding: 15px; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1); max-height: 200px; overflow-y: auto;">
                    <h4 style="color: #ffa502; margin-bottom: 10px;">üì¶ Productos a reabastecer:</h4>
                    <div id="listaReabastecimiento"></div>
                </div>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="btn-success" onclick="confirmarReabastecimiento()">üìà Confirmar
                    Reabastecimiento</button>
                <button class="btn-primary" onclick="cerrarModalReabastecimiento()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Cobro con Cambio -->
    <div id="modalCobro" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="cerrarModalCobro()">&times;</span>
            <h2 style="margin-bottom: 25px; color: #fff; text-align: center;">üí∞ Procesar Cobro</h2>

            <div style="text-align: center; margin-bottom: 20px;">
                <div
                    style="background: rgba(255, 107, 107, 0.2); border: 1px solid rgba(255, 107, 107, 0.5); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                    <h3 style="color: #ffa502; margin: 0;">Total a Cobrar</h3>
                    <div id="totalACobrar" style="font-size: 2.5em; font-weight: bold; color: #fff; margin-top: 10px;">
                        ‚Ç¨0.00</div>
                </div>
            </div>

            <div style="display: grid; gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 5px; color: #888; font-weight: 600;">üí≥ M√©todo de
                        Pago:</label>
                    <select id="metodoPago" onchange="toggleCantidadRecibida()"
                        style="width: 100%; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                        <option value="efectivo">üíµ Efectivo</option>
                        <option value="tarjeta">üí≥ Tarjeta</option>
                        <option value="bizum">üì± Bizum</option>
                        <option value="transferencia">üè¶ Transferencia</option>
                    </select>
                </div>

                <div id="seccionEfectivo">
                    <label style="display: block; margin-bottom: 5px; color: #888; font-weight: 600;">üíµ Cantidad
                        Recibida:</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="number" id="cantidadRecibida" placeholder="0.00" step="0.01" min="0"
                            oninput="calcularCambio()"
                            style="flex: 1; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;">
                        <button type="button" onclick="establecerImporteExacto()"
                            style="background: #4a5568; color: white; border: none; padding: 12px 15px; border-radius: 8px; cursor: pointer; font-size: 14px; white-space: nowrap;">
                            Exacto
                        </button>
                    </div>
                </div>

                <div id="seccionCambio"
                    style="background: rgba(30, 30, 30, 0.9); padding: 15px; border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #888; font-weight: 600;">üí∞ Cambio:</span>
                        <span id="cambioCalculado"
                            style="font-size: 1.5em; font-weight: bold; color: #22c55e;">‚Ç¨0.00</span>
                    </div>
                </div>
            </div>
            <!-- Checkbox para impresi√≥n de ticket -->
            <div id="seccionImprimir"
                style="margin-top: 15px; padding: 12px; background: rgba(40, 40, 40, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; display: none;">
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; color: #ffa502;">
                    <input type="checkbox" id="imprimirTicketCheck" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-size: 16px; font-weight: 600;">üñ®Ô∏è Imprimir Ticket</span>
                </label>
            </div>

            <div style="margin-top: 20px; text-align: center; display: flex; gap: 12px; justify-content: center;">
                <button id="confirmarCobroBtn" class="btn-success" onclick="confirmarCobro()" disabled
                    style="opacity: 0.5; padding: 15px 30px; font-size: 16px; font-weight: bold;">
                    ‚úÖ Confirmar Cobro
                </button>
                <button class="btn-primary" onclick="cerrarModalCobro()" style="padding: 15px 30px; font-size: 16px;">
                    ‚ùå Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Teclado Num√©rico Virtual -->
    <div id="tecladoNumerico" class="teclado-numerico" style="display: none;">
        <div class="teclado-container">
            <div class="teclado-display">
                <input type="text" id="tecladoInput" readonly>
            </div>
            <div class="teclado-grid">
                <button class="tecla-num" onclick="agregarNumero('7')">7</button>
                <button class="tecla-num" onclick="agregarNumero('8')">8</button>
                <button class="tecla-num" onclick="agregarNumero('9')">9</button>
                <button class="tecla-func tecla-borrar" onclick="borrarUltimo()">‚å´</button>

                <button class="tecla-num" onclick="agregarNumero('4')">4</button>
                <button class="tecla-num" onclick="agregarNumero('5')">5</button>
                <button class="tecla-num" onclick="agregarNumero('6')">6</button>
                <button class="tecla-func tecla-limpiar" onclick="limpiarTeclado()">C</button>

                <button class="tecla-num" onclick="agregarNumero('1')">1</button>
                <button class="tecla-num" onclick="agregarNumero('2')">2</button>
                <button class="tecla-num" onclick="agregarNumero('3')">3</button>
                <button class="tecla-func tecla-decimal" onclick="agregarDecimal()">.</button>

                <button class="tecla-num tecla-cero" onclick="agregarNumero('0')">0</button>
                <button class="tecla-num" onclick="agregarNumero('00')">00</button>
                <button class="tecla-func tecla-ok" onclick="confirmarTeclado()">‚úì</button>
            </div>
            <button class="tecla-cerrar" onclick="cerrarTeclado()">‚úï Cerrar</button>
        </div>
    </div>

    <!-- Teclado Completo Virtual -->
    <div id="tecladoCompleto" class="teclado-completo" style="display: none;">
        <div class="teclado-container">
            <div class="teclado-display">
                <input type="text" id="tecladoCompletoInput" readonly>
            </div>
            <div class="teclado-grid-completo">
                <!-- Primera fila -->
                <button class="tecla" onclick="agregarLetra('1')">1</button>
                <button class="tecla" onclick="agregarLetra('2')">2</button>
                <button class="tecla" onclick="agregarLetra('3')">3</button>
                <button class="tecla" onclick="agregarLetra('4')">4</button>
                <button class="tecla" onclick="agregarLetra('5')">5</button>
                <button class="tecla" onclick="agregarLetra('6')">6</button>
                <button class="tecla" onclick="agregarLetra('7')">7</button>
                <button class="tecla" onclick="agregarLetra('8')">8</button>
                <button class="tecla" onclick="agregarLetra('9')">9</button>
                <button class="tecla" onclick="agregarLetra('0')">0</button>
                <button class="tecla tecla-func" onclick="borrarUltimoCompleto()">‚å´</button>

                <!-- Segunda fila -->
                <button class="tecla" onclick="agregarLetra('Q')">Q</button>
                <button class="tecla" onclick="agregarLetra('W')">W</button>
                <button class="tecla" onclick="agregarLetra('E')">E</button>
                <button class="tecla" onclick="agregarLetra('R')">R</button>
                <button class="tecla" onclick="agregarLetra('T')">T</button>
                <button class="tecla" onclick="agregarLetra('Y')">Y</button>
                <button class="tecla" onclick="agregarLetra('U')">U</button>
                <button class="tecla" onclick="agregarLetra('I')">I</button>
                <button class="tecla" onclick="agregarLetra('O')">O</button>
                <button class="tecla" onclick="agregarLetra('P')">P</button>
                <button class="tecla tecla-func" onclick="limpiarTecladoCompleto()">CLR</button>

                <!-- Tercera fila -->
                <button class="tecla" onclick="agregarLetra('A')">A</button>
                <button class="tecla" onclick="agregarLetra('S')">S</button>
                <button class="tecla" onclick="agregarLetra('D')">D</button>
                <button class="tecla" onclick="agregarLetra('F')">F</button>
                <button class="tecla" onclick="agregarLetra('G')">G</button>
                <button class="tecla" onclick="agregarLetra('H')">H</button>
                <button class="tecla" onclick="agregarLetra('J')">J</button>
                <button class="tecla" onclick="agregarLetra('K')">K</button>
                <button class="tecla" onclick="agregarLetra('L')">L</button>
                <button class="tecla" onclick="agregarLetra('√ë')">√ë</button>
                <button class="tecla tecla-espacio-pequeno" onclick="agregarLetra(' ')">‚ê£</button>

                <!-- Cuarta fila -->
                <button class="tecla" onclick="agregarLetra('Z')">Z</button>
                <button class="tecla" onclick="agregarLetra('X')">X</button>
                <button class="tecla" onclick="agregarLetra('C')">C</button>
                <button class="tecla" onclick="agregarLetra('V')">V</button>
                <button class="tecla" onclick="agregarLetra('B')">B</button>
                <button class="tecla" onclick="agregarLetra('N')">N</button>
                <button class="tecla" onclick="agregarLetra('M')">M</button>
                <button class="tecla" onclick="agregarLetra('.')">.</button>
                <button class="tecla" onclick="agregarLetra(',')">,</button>
                <button class="tecla tecla-func tecla-ok" onclick="confirmarTecladoCompleto()">‚úì</button>
            </div>
            <div class="teclado-fila-inferior">
                <button class="tecla-espacio" onclick="agregarLetra(' ')">ESPACIO</button>
                <button class="tecla-cerrar" onclick="cerrarTecladoCompleto()">‚úï Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Premium -->
    <div id="modalPremium" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="cerrarModalPremium()">&times;</span>
            <h2
                style="background: linear-gradient(135deg, #ff6b6b 0%, #ffa502 50%, #ffd700 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; margin-bottom: 30px; font-size: 2.5em;">
                ‚ö° Potencia tu Negocio
            </h2>

            <!-- Planes de precios -->
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px;">

                <!-- Plan Standard -->
                <div
                    style="background: rgba(40, 40, 40, 0.9); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 255, 255, 0.1); position: relative;">
                    <h3 style="color: #888; text-align: center; margin-bottom: 10px;">Standard</h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <div style="font-size: 3em; font-weight: bold; color: #4a5568;">49‚Ç¨</div>
                        <div style="color: #888;">al mes</div>
                        <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                            <s style="opacity: 0.7;">Gratis</s> ‚Üí Con soporte
                        </div>
                    </div>
                    <ul style="list-style: none; padding: 0; margin: 20px 0;">
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Control de mesas completo</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Gesti√≥n de productos</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Facturaci√≥n completa</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Inventario completo</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Exportaci√≥n de datos</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚úÖ Soporte t√©cnico</li>
                        <li style="padding: 8px 0; color: #888;">‚úó Sin an√°lisis avanzado</li>
                        <li style="padding: 8px 0; color: #888;">‚úó Sin gr√°ficos</li>
                    </ul>
                    <button class="btn-primary" onclick="seleccionarPlan('standard')" style="width: 100%;">
                        Activar Standard
                    </button>
                </div>

                <!-- Plan Pro - M√ÅS POPULAR -->
                <div
                    style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 165, 2, 0.1)); padding: 25px; border-radius: 15px; border: 2px solid #ffa502; position: relative; transform: scale(1.05); box-shadow: 0 10px 30px rgba(255, 165, 2, 0.3);">
                    <div
                        style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: #ffa502; color: white; padding: 5px 20px; border-radius: 20px; font-weight: bold; font-size: 0.9em;">
                        üî• M√ÅS POPULAR
                    </div>
                    <h3 style="color: #ffa502; text-align: center; margin-bottom: 10px; margin-top: 10px;">Pro</h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <div style="font-size: 3em; font-weight: bold; color: #ffa502;">69‚Ç¨</div>
                        <div style="color: #888;">al mes</div>
                        <div style="color: #22c55e; font-size: 0.9em; margin-top: 5px;">
                            üí∞ Ahorra 468‚Ç¨/a√±o vs. competencia
                        </div>
                    </div>
                    <ul style="list-style: none; padding: 0; margin: 20px 0;">
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Todo de Standard +</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>An√°lisis de ventas diarias</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Gr√°ficos b√°sicos</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Filtros por categor√≠a</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Exportaci√≥n CSV mejorada</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Historial 90 d√≠as</strong></li>
                        <li style="padding: 8px 0; color: #fff;">‚úÖ <strong>Soporte prioritario</strong></li>
                    </ul>
                    <button class="btn-warning" onclick="seleccionarPlan('pro')"
                        style="width: 100%; padding: 15px; font-size: 16px; font-weight: bold; animation: pulse 2s infinite;">
                        üöÄ Elegir Pro
                    </button>
                </div>

                <!-- Plan Premium -->
                <div
                    style="background: rgba(30, 30, 30, 0.9); padding: 25px; border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.3); position: relative;">
                    <div
                        style="position: absolute; top: -15px; right: 20px; background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 0.8em;">
                        ‚≠ê √âLITE
                    </div>
                    <h3
                        style="background: linear-gradient(135deg, #ffd700, #ffed4e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; margin-bottom: 10px;">
                        Premium</h3>
                    <div style="text-align: center; margin: 20px 0;">
                        <div
                            style="font-size: 3em; font-weight: bold; background: linear-gradient(135deg, #ffd700, #ffed4e); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                            130‚Ç¨</div>
                        <div style="color: #888;">al mes</div>
                        <div style="color: #ffd700; font-size: 0.9em; margin-top: 5px;">
                            üëë La suite completa
                        </div>
                    </div>
                    <ul style="list-style: none; padding: 0; margin: 20px 0;">
                        <li style="padding: 8px 0; color: #ffd700;">‚òÖ <strong>Todo de Pro +</strong></li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ An√°lisis predictivo IA</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ Gr√°ficos interactivos ilimitados</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ Dashboard personalizable</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ API para integraciones</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ Multi-sucursal</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ Soporte 24/7 dedicado</li>
                        <li style="padding: 8px 0; color: #e0e0e0;">‚òÖ Formaci√≥n personalizada</li>
                    </ul>
                    <button class="btn-success" onclick="seleccionarPlan('premium')"
                        style="width: 100%; background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; border: none;">
                        üëë Elegir Premium
                    </button>
                </div>
            </div>

            <!-- Garant√≠as -->
            <div style="text-align: center; margin: 30px 0;">
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2em;">üîí</span>
                        <span>Pago 100% Seguro</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2em;">üí∞</span>
                        <span>30 d√≠as de garant√≠a</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 2em;">üö´</span>
                        <span>Cancela cuando quieras</span>
                    </div>
                </div>
            </div>

            <!-- Formulario de activaci√≥n (oculto por defecto) -->
            <div id="formularioActivacion" style="display: none; margin-top: 30px;">
                <!-- Aqu√≠ ir√° el formulario cuando seleccionen un plan -->
            </div>

            <!-- Opciones -->
            <div id="opcionesPremium">

                <div style="text-align: center; margin: 20px 0;">
                    <span style="color: #888;">‚Äî O ‚Äî</span>
                </div>

                <div style="background: rgba(40, 40, 40, 0.9); padding: 20px; border-radius: 10px;">
                    <h4 style="color: #ffa502; margin-bottom: 15px;">üîë ¬øYa tienes una licencia?</h4>
                    <input type="text" id="licenciaInput" placeholder="PREM-XXXX-XXXX-XXXX"
                        style="width: 100%; padding: 12px; background: rgba(30, 30, 30, 0.9); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; margin-bottom: 10px; font-family: monospace; text-align: center;">
                    <button class="btn-primary" onclick="validarLicencia()" style="width: 100%;">
                        Activar Licencia
                    </button>
                </div>
            </div>

            <!-- Mensaje de √©xito (oculto por defecto) -->
            <div id="mensajeExito"
                style="display: none; background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; padding: 20px; border-radius: 10px; text-align: center;">
                <h3 style="color: #22c55e; margin-bottom: 10px;">‚úÖ ¬°Activaci√≥n Exitosa!</h3>
                <p id="mensajeExitoTexto">Tu versi√≥n premium est√° activa.</p>
                <button class="btn-success" onclick="location.reload()" style="margin-top: 15px;">
                    Recargar Aplicaci√≥n
                </button>
            </div>

        </div>
    </div>

    <script src="DatabaseManager.js"></script>
    <script src="version.js"></script>
    <script src="script.js"></script>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('./sw.js')
                    .then(function (registration) {
                        console.log('ServiceWorker registrado con √©xito:', registration.scope);
                    })
                    .catch(function (error) {
                        console.log('Error al registrar ServiceWorker:', error);
                    });
            });
        }
    </script>

</body>

</html>